function [v_sn, n_sn, I_app_sn] = CSred_genV0_sn_coordinates(gA, v0, options)
%Calculation of coordinates of saddle-node (SN) bifurcation
%   The saddle node is the situation where the V-nullcline and
%   n-nullcline are tangential, irrespective of the epsilon value

%% Constants

% Reversal potentials
ENa = 55;
EK = -75;
El = -17;

% Conductances
gl = 0.3;
gNa = 120;
gKDR = 20;


%% Differentials

% With v0 as dynamical variable and without timescale
dVdVC_V0 = @(V, n, gA) -120/((exp(224164298057848/1304196378821855 - (613455931296362*log(1/n - 1))/260839275764371) + 1)*(exp(- (562949953421312*V)/5329489831328509 - 16739365515052668/5329489831328509) + 1)^3) - 20*n^4 - gA/((exp(- (35184372088832*V)/1820115906168013 - 2678129957135078/1820115906168013) + 1)^3*(exp(9399834565864460/3215394367055963 - (4600919484722715*log(1/n - 1))/3215394367055963) + 1)) - (202661983231672320*exp(- (562949953421312*V)/5329489831328509 - 16739365515052668/5329489831328509)*(V - 55))/(5329489831328509*(exp(224164298057848/1304196378821855 - (613455931296362*log(1/n - 1))/260839275764371) + 1)*(exp(- (562949953421312*V)/5329489831328509 - 16739365515052668/5329489831328509) + 1)^4) - (105553116266496*gA*exp(- (35184372088832*V)/1820115906168013 - 2678129957135078/1820115906168013)*(V + 75))/(1820115906168013*(exp(- (35184372088832*V)/1820115906168013 - 2678129957135078/1820115906168013) + 1)^4*(exp(9399834565864460/3215394367055963 - (4600919484722715*log(1/n - 1))/3215394367055963) + 1)) - 3/10;
dVdnC_V0 = @(V, n, gA)(73614711755563440*exp(224164298057848/1304196378821855 - (613455931296362*log(1/n - 1))/260839275764371)*(V - 55))/(260839275764371*n^2*(exp(224164298057848/1304196378821855 - (613455931296362*log(1/n - 1))/260839275764371) + 1)^2*(1/n - 1)*(exp(- (562949953421312*V)/5329489831328509 - 16739365515052668/5329489831328509) + 1)^3) - 80*n^3*(V + 75) + (4600919484722715*gA*exp(9399834565864460/3215394367055963 - (4600919484722715*log(1/n - 1))/3215394367055963)*(V + 75))/(3215394367055963*n^2*(exp(- (35184372088832*V)/1820115906168013 - 2678129957135078/1820115906168013) + 1)^3*(1/n - 1)*(exp(9399834565864460/3215394367055963 - (4600919484722715*log(1/n - 1))/3215394367055963) + 1)^2);
dndVT_V0 = @(V, V0) (281474976710656*exp((281474976710656*V0)/4600919484722715 - (281474976710656*V)/4600919484722715))/(4600919484722715*(exp((281474976710656*V0)/4600919484722715 - (281474976710656*V)/4600919484722715) + 1)^2);
dndnT_V0 = -1;

%% Get v_sn coorinates

%Get SNIC bifurcation info
[v_sn, ~, exitflag] = fsolve(@(V) ((dVdVC_V0(V, functions.ninf_genV0(V, v0), gA) * dndnT_V0) - (dVdnC_V0(V, functions.ninf_genV0(V, v0), gA) * dndVT_V0(V, v0))), -53, options);

%nSN and IappSN
if exitflag > 0 && v_sn > -80
    n_sn = functions.ninf_genV0(v_sn, v0);
    I_app_sn = -( (-gNa.*functions.minf_gen(v_sn).^3 ...
        .* functions.hinf_gen(functions.inv_ninf_gen(n_sn)) ...
        * (v_sn-ENa) -gKDR.*n_sn.^4*(v_sn-EK) - gA.*functions.mAinf_gen(v_sn).^3 ...
        .* functions.hAinf_gen(functions.inv_ninf_gen(n_sn))*(v_sn-EK) ...
        - gl*(v_sn-El)) );
else
    v_sn = nan;
    n_sn = nan;
    I_app_sn = nan;
end

end

